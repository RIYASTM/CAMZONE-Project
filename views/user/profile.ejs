<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Profile</title>
    <link rel="stylesheet" href="/stylesheet/user/profile.css">
</head>
<body>
    <header>
        <%- include('../partials/users/header',{search , cart}) %>
    </header>
    <div class="container">
        <!-- Navigation Breadcrumb -->
        <div class="breadcrumb">
            <a href="/">Home</a>
            <span class="separator">></span>
            <a href="/myAccount">My Account</a>
            <span class="separator">></span>
            <a href="/profile">My Details</a>
            <span class="separator">></span>
            <span class="current">My Profile</span>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- Sidebar Navigation -->

            <%- include('../partials/users/sideBar', {currentPage : 'My Profile'}) %>

            <!-- Profile Form -->
            <div id="profile-section" class="profile-form">
                <h2>Update Profile</h2>
                <button type="button" id="cancelProfileButton" class="btn-cancel" >&times;</button>
                
                <form enctype="multipart/form-data" id="profileForm">
                    <div class="form-layout">
                        
                        <div class="form-fields">
                            <div class="form-group">
                                <label for="name">Name <span class="required">*</span> :</label>
                                <input type="text" id="name" name="name" value="<%= user.name || 'Alex' %>" disabled>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="form-group">
                                <label for="phone">Phone No <span class="required">*</span> :</label>
                                <input type="tel" id="phone" name="phone" value="<%= user.phone || '+91 8086508788' %>" disabled>
                                <div class="invalid-feedback"></div>
                            </div>
                            <div class="form-group">
                                <label for="email">Email <span class="required">*</span> :</label>
                                <input type="email" id="email" name="email" value="<%= user.email || 'johnalex@gmail.com' %>" disabled>
                                <div class="invalid-feedback"></div>
                            </div>
                        </div>
                        
                        <div class="profile-picture-section">
                            <label>Profile Picture</label>
                            <div class="profile-picture-container" id="profilePicContainer">
                                <% if (user && user.profileImage) { %>
                                    <img src="/uploads/profile/<%= user.profileImage %>" alt="<%= user.name %>" id="profilePreview" onerror="this.src='https://via.placeholder.com/120?text=Image+Not+Found'">
                                <% } else { %>
                                    <div class="profile-placeholder">
                                        <span class="plus-icon">+</span>
                                    </div>
                                <% } %>
                                <input type="file" id="profileImage" name="profileImage" accept="image/*" style="display: none;" disabled>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" id="changePassword" class="btn-edit">Change Paassword</button>
                        <button type="button" id="editProfileButton" form="profileForm" class="btn-edit">Edit</button>
                    </div>
                </form>
            </div>

            <div id="passwordModal" class="modal">
                <div id="password-section" class="profile-form">
                    <h2>Change Password</h2>
                    <button type="button" id="cancelPasswordButton" class="btn-cancel" >&times;</button>
                    <form id="changePasswordForm">
                        <!-- Current Password and OTP in the same row -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="currentPassword">Current Password <span class="required">*</span></label>
                                <div class="input-with-button">
                                    <input type="password" id="currentPassword" name="currentPassword" class="currentPassword" placeholder="Current Password" required>
                                    <button type="button" id="sendOtpButton" class="btn-verify">Send OTP</button>
                                </div>
                                <div class="invalid-feedback currentPasswordError"></div>
                            </div>

                            <div class="form-group">
                                <label for="otp">Enter OTP <span class="required">*</span></label>
                                <div class="otp-section">
                                    <div class="otp-input-wrapper" id="otpInputs">
                                        <input type="text" class="otp-input" maxlength="1" required>
                                        <input type="text" class="otp-input" maxlength="1" required>
                                        <input type="text" class="otp-input" maxlength="1" required>
                                        <input type="text" class="otp-input" maxlength="1" required>
                                        <input type="text" class="otp-input" maxlength="1" required>
                                        <input type="text" class="otp-input" maxlength="1" required>
                                    </div>
                                    <button type="button" id="verifyOtpButton" class="btn-verify">Verify</button>
                                </div>
                                <div class="invalid-feedback"></div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="newPassword">New Password <span class="required">*</span></label>
                            <input type="password" id="newPassword" name="newPassword" class="newPassword" placeholder="New Password" required disabled>
                            <div class="invalid-feedback"></div>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword">Confirm New Password <span class="required">*</span></label>
                            <input type="password" id="confirmPassword" name="confirmPassword" class="confirmPassword" placeholder="Confirm New Password" required disabled>
                            <div class="invalid-feedback"></div>
                        </div>

                        <div class="form-actions">
                            <button type="submit" class="btn-save" disabled>Update Password</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <%- include('../partials/users/footer') %>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="/javascript/users/profile.js"></script>
</body>
</html>